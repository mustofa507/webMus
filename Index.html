<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TikTok Downloader</title>
<style>
    body { font-family: Arial; background:#f0f2f5; display:flex; flex-direction:column; align-items:center; padding:2rem;}
    h1 { color:#333; }
    input { width:80%; padding:0.5rem; margin:0.5rem 0; border-radius:5px; border:1px solid #ccc;}
    button { padding:0.5rem 1rem; margin:0.5rem; border:none; border-radius:5px; background:#4CAF50; color:white; cursor:pointer;}
    button:hover { background:#45a049;}
    .result { margin-top:1rem; }
</style>
</head>
<body>
<h1>TikTok Downloader</h1>
<input type="text" id="urlInput" placeholder="Paste URL TikTok di sini" />
<button onclick="downloadVideo('normal')">Download Video</button>
<button onclick="downloadVideo('hd')">Download Video HD</button>
<button onclick="downloadVideo('music')">Download Audio</button>

<div class="result" id="result"></div>

<script>
async function downloadVideo(type){
    const url = document.getElementById('urlInput').value.trim();
    if(!url) return alert("Masukkan URL TikTok dulu!");
    const resultDiv = document.getElementById('result');
    resultDiv.innerHTML = "Processing...";
    
    try {
        const res = await fetch(`/api/tiktok?url=${encodeURIComponent(url)}&type=${type}`);
        const data = await res.json();
        if(data.success){
            const a = document.createElement('a');
            a.href = data.link;
            a.download = ""; // langsung download
            document.body.appendChild(a);
            a.click();
            a.remove();
            resultDiv.innerHTML = "Download dimulai!";
        } else {
            resultDiv.innerHTML = "Gagal: " + data.message;
        }
    } catch(err){
        resultDiv.innerHTML = "Error: " + err.message;
    }
}
</script>
</body>
</html>